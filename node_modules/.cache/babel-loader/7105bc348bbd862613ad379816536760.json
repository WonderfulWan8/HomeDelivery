{"remainingRequest":"E:\\HomeDelivery\\node_modules\\babel-loader\\lib\\index.js!E:\\HomeDelivery\\node_modules\\eslint-loader\\index.js??ref--14-0!E:\\HomeDelivery\\src\\effects\\cartEffects.js","dependencies":[{"path":"E:\\HomeDelivery\\src\\effects\\cartEffects.js","mtime":1643528918942},{"path":"E:\\HomeDelivery\\babel.config.js","mtime":1643435139739},{"path":"E:\\HomeDelivery\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1643435142996},{"path":"E:\\HomeDelivery\\node_modules\\babel-loader\\lib\\index.js","mtime":1643435142701},{"path":"E:\\HomeDelivery\\node_modules\\eslint-loader\\index.js","mtime":1643435145678}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkLmpzIjsKaW1wb3J0IHsgY29tcHV0ZWQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOyAvLyDotK3nianovabnm7jlhbPpgLvovpEKCmV4cG9ydCB2YXIgdXNlQ29tbW9tQ2FydEVmZmVjdCA9IGZ1bmN0aW9uIHVzZUNvbW1vbUNhcnRFZmZlY3Qoc2hvcElkKSB7CiAgdmFyIHN0b3JlID0gdXNlU3RvcmUoKTsKICB2YXIgY2FydExpc3QgPSBzdG9yZS5zdGF0ZS5jYXJ0TGlzdDsKCiAgdmFyIGNoYW5nZUNhcnRJdGVtSW5mbyA9IGZ1bmN0aW9uIGNoYW5nZUNhcnRJdGVtSW5mbyhzaG9wSWQsIHByb2R1Y3RJZCwgcHJvZHVjdEluZm8sIG51bSkgewogICAgc3RvcmUuY29tbWl0KCdjaGFuZ2VDYXJ0SXRlbUluZm8nLCB7CiAgICAgIHNob3BJZDogc2hvcElkLAogICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCwKICAgICAgcHJvZHVjdEluZm86IHByb2R1Y3RJbmZvLAogICAgICBudW06IG51bQogICAgfSk7CiAgfTsKCiAgdmFyIHByb2R1Y3RMaXN0ID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQ7CgogICAgdmFyIHByb2R1Y3RMaXN0ID0gKChfY2FydExpc3Qkc2hvcElkID0gY2FydExpc3Rbc2hvcElkXSkgPT09IG51bGwgfHwgX2NhcnRMaXN0JHNob3BJZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NhcnRMaXN0JHNob3BJZC5wcm9kdWN0TGlzdCkgfHwgW107CiAgICByZXR1cm4gcHJvZHVjdExpc3Q7CiAgfSk7CiAgdmFyIHNob3BOYW1lID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgdmFyIF9jYXJ0TGlzdCRzaG9wSWQyOwoKICAgIC8vIOWmguaenOatpOWkhOS7heWBmuWPluWAvOiAjOS4jeS9v+eUqOiuoeeul+WxnuaAp++8jOS8muWvvOiHtOWmguaenHNob3BJZOWPmOWMluaXtu+8jOiOt+WPluS4jeWIsHNob3BOYW1lCiAgICB2YXIgc2hvcE5hbWUgPSAoKF9jYXJ0TGlzdCRzaG9wSWQyID0gY2FydExpc3Rbc2hvcElkXSkgPT09IG51bGwgfHwgX2NhcnRMaXN0JHNob3BJZDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jYXJ0TGlzdCRzaG9wSWQyLnNob3BOYW1lKSB8fCAnJzsKICAgIHJldHVybiBzaG9wTmFtZTsKICB9KTsgLy8g6K6h566X5oC75Lu35qC8CgogIHZhciBjYWN1bGF0aW9ucyA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHZhciBfY2FydExpc3Qkc2hvcElkMzsKCiAgICB2YXIgcHJvZHVjdExpc3QgPSAoX2NhcnRMaXN0JHNob3BJZDMgPSBjYXJ0TGlzdFtzaG9wSWRdKSA9PT0gbnVsbCB8fCBfY2FydExpc3Qkc2hvcElkMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NhcnRMaXN0JHNob3BJZDMucHJvZHVjdExpc3Q7IC8v6K+75Y+W5b2T5YmN5ZWG6ZO65LiL55qE5ZWG5ZOB5YiX6KGo77yIdnVleO+8iQoKICAgIHZhciByZXN1bHQgPSB7CiAgICAgIHRvdGFsOiAwLAogICAgICBwcmljZTogMCwKICAgICAgYWxsQ2hlY2tlZDogdHJ1ZQogICAgfTsgLy8g6K6h566X6LSt54mp6L2m5YaF5ZWG5ZOB5oC75pWwLCDmgLvku7csIOaYr+WQpuWFqOmAiQoKICAgIGlmIChwcm9kdWN0TGlzdCkgewogICAgICBmb3IgKHZhciBpIGluIHByb2R1Y3RMaXN0KSB7CiAgICAgICAgLy/or7vlj5bmr4/kuKrllYblk4HnmoRjb3VudAogICAgICAgIHZhciBwcm9kdWN0ID0gcHJvZHVjdExpc3RbaV07CiAgICAgICAgcmVzdWx0LnRvdGFsICs9IHByb2R1Y3QuY291bnQ7CgogICAgICAgIGlmIChwcm9kdWN0LmNoZWNrKSB7CiAgICAgICAgICAvLyDli77pgInkuIrnmoTmiY3orqHnrpfku7fpkrEKICAgICAgICAgIHJlc3VsdC5wcmljZSArPSBwcm9kdWN0LmNvdW50ICogcHJvZHVjdC5wcmljZTsKICAgICAgICB9CgogICAgICAgIGlmIChwcm9kdWN0LmNvdW50ID4gMCAmJiAhcHJvZHVjdC5jaGVjaykgewogICAgICAgICAgcmVzdWx0LmFsbENoZWNrZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXN1bHQucHJpY2UgPSByZXN1bHQucHJpY2UudG9GaXhlZCgyKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfSk7CiAgcmV0dXJuIHsKICAgIGNhcnRMaXN0OiBjYXJ0TGlzdCwKICAgIHByb2R1Y3RMaXN0OiBwcm9kdWN0TGlzdCwKICAgIHNob3BOYW1lOiBzaG9wTmFtZSwKICAgIGNoYW5nZUNhcnRJdGVtSW5mbzogY2hhbmdlQ2FydEl0ZW1JbmZvLAogICAgY2FjdWxhdGlvbnM6IGNhY3VsYXRpb25zCiAgfTsKfTs="},{"version":3,"sources":["E:/HomeDelivery/src/effects/cartEffects.js"],"names":["computed","useStore","useCommomCartEffect","shopId","store","cartList","state","changeCartItemInfo","productId","productInfo","num","commit","productList","shopName","caculations","result","total","price","allChecked","i","product","count","check","toFixed"],"mappings":";AAAA,SAASA,QAAT,QAAyB,KAAzB;AACA,SAASC,QAAT,QAAyB,MAAzB,C,CACA;;AACA,OAAO,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,MAAD,EAAW;AAC1C,MAAMC,KAAK,GAAGH,QAAQ,EAAtB;AACA,MAAMI,QAAQ,GAAGD,KAAK,CAACE,KAAN,CAAYD,QAA7B;;AACA,MAAME,kBAAkB,GAAG,SAArBA,kBAAqB,CAACJ,MAAD,EAASK,SAAT,EAAoBC,WAApB,EAAiCC,GAAjC,EAAyC;AAChEN,IAAAA,KAAK,CAACO,MAAN,CAAa,oBAAb,EAAkC;AAC9BR,MAAAA,MAAM,EAANA,MAD8B;AACtBK,MAAAA,SAAS,EAATA,SADsB;AACXC,MAAAA,WAAW,EAAXA,WADW;AACEC,MAAAA,GAAG,EAAHA;AADF,KAAlC;AAGH,GAJD;;AAKA,MAAME,WAAW,GAAGZ,QAAQ,CAAC,YAAI;AAAA;;AAC7B,QAAMY,WAAW,GAAG,qBAAAP,QAAQ,CAACF,MAAD,CAAR,sEAAkBS,WAAlB,KAAiC,EAArD;AACA,WAAOA,WAAP;AACH,GAH2B,CAA5B;AAIA,MAAMC,QAAQ,GAAGb,QAAQ,CAAE,YAAI;AAAA;;AAC3B;AACA,QAAMa,QAAQ,GAAG,sBAAAR,QAAQ,CAACF,MAAD,CAAR,wEAAkBU,QAAlB,KAA8B,EAA/C;AACA,WAAOA,QAAP;AACH,GAJwB,CAAzB,CAZ0C,CAkB1C;;AACA,MAAMC,WAAW,GAAGd,QAAQ,CAAE,YAAM;AAAA;;AAChC,QAAMY,WAAW,wBAAGP,QAAQ,CAACF,MAAD,CAAX,sDAAG,kBAAkBS,WAAtC,CADgC,CACiB;;AACjD,QAAMG,MAAM,GAAG;AAAEC,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,KAAK,EAAE,CAAnB;AAAsBC,MAAAA,UAAU,EAAE;AAAlC,KAAf,CAFgC,CAEsB;;AACtD,QAAGN,WAAH,EAAe;AACX,WAAI,IAAIO,CAAR,IAAaP,WAAb,EAAyB;AAAC;AACtB,YAAMQ,OAAO,GAAGR,WAAW,CAACO,CAAD,CAA3B;AACAJ,QAAAA,MAAM,CAACC,KAAP,IAAgBI,OAAO,CAACC,KAAxB;;AACA,YAAGD,OAAO,CAACE,KAAX,EAAiB;AAAG;AAChBP,UAAAA,MAAM,CAACE,KAAP,IAAkBG,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACH,KAA1C;AACH;;AACD,YAAGG,OAAO,CAACC,KAAR,GAAgB,CAAhB,IAAqB,CAACD,OAAO,CAACE,KAAjC,EAAuC;AACnCP,UAAAA,MAAM,CAACG,UAAP,GAAoB,KAApB;AACH;AACJ;AACJ;;AACDH,IAAAA,MAAM,CAACE,KAAP,GAAeF,MAAM,CAACE,KAAP,CAAaM,OAAb,CAAqB,CAArB,CAAf;AACA,WAAOR,MAAP;AACH,GAjB2B,CAA5B;AAoBA,SAAO;AAAEV,IAAAA,QAAQ,EAARA,QAAF;AAAYO,IAAAA,WAAW,EAAXA,WAAZ;AAAyBC,IAAAA,QAAQ,EAARA,QAAzB;AAAmCN,IAAAA,kBAAkB,EAAlBA,kBAAnC;AAAuDO,IAAAA,WAAW,EAAXA;AAAvD,GAAP;AACH,CAxCM","sourcesContent":["import { computed } from 'vue';\r\nimport { useStore } from 'vuex'\r\n// 购物车相关逻辑\r\nexport const useCommomCartEffect = (shopId) =>{\r\n    const store = useStore();\r\n    const cartList = store.state.cartList;\r\n    const changeCartItemInfo = (shopId, productId, productInfo, num) => {\r\n        store.commit('changeCartItemInfo',{\r\n            shopId, productId, productInfo, num\r\n        })\r\n    };\r\n    const productList = computed(()=>{\r\n        const productList = cartList[shopId]?.productList || []\r\n        return productList\r\n    });\r\n    const shopName = computed( ()=>{\r\n        // 如果此处仅做取值而不使用计算属性，会导致如果shopId变化时，获取不到shopName\r\n        const shopName = cartList[shopId]?.shopName || ''\r\n        return shopName\r\n    });\r\n\r\n    // 计算总价格\r\n    const caculations = computed (() => {\r\n        const productList = cartList[shopId]?.productList//读取当前商铺下的商品列表（vuex）\r\n        const result = { total: 0, price: 0, allChecked: true}// 计算购物车内商品总数, 总价, 是否全选\r\n        if(productList){\r\n            for(let i in productList){//读取每个商品的count\r\n                const product = productList[i]\r\n                result.total += product.count\r\n                if(product.check){  // 勾选上的才计算价钱\r\n                    result.price += ( product.count * product.price )\r\n                }\r\n                if(product.count > 0 && !product.check){\r\n                    result.allChecked = false;\r\n                }\r\n            }\r\n        }\r\n        result.price = result.price.toFixed(2);\r\n        return result \r\n    })\r\n    \r\n\r\n    return { cartList, productList, shopName, changeCartItemInfo, caculations }\r\n}"]}]}